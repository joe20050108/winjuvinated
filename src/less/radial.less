//Joseph Babaian
//Code is from Microsoft, modified to support normal HTML.